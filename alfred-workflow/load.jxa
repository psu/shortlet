#!/usr/bin/osascript -l JavaScript

function run(argv) {
  const code = argv[0]
  const shortlets = argv[1]
  const browser = argv[2]

  const injectee = `
    if (typeof ShortletRunner !== 'object') {
      ${code}
      var ShortletList = ShortletRunner.load(${shortlets})
    } else { console.log('Runner (load): Already loaded') }
  `
  return Application( browser ).windows[0].activeTab.execute( {javascript: injectee} )
}